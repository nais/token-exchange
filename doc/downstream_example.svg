<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1704px" preserveAspectRatio="none" style="width:1860px;height:1704px;" version="1.1" viewBox="0 0 1860 1704" width="1860px" zoomAndPan="magnify"><defs><filter height="300%" id="fodmp8fzkq3b1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="4.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="8.0" dy="8.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fodmp8fzkq3b1)" height="294.3477" style="stroke: #000000; stroke-width: 4.0;" width="774" x="26" y="293.5977"/><rect fill="#FFFFFF" filter="url(#fodmp8fzkq3b1)" height="440.2109" style="stroke: #000000; stroke-width: 4.0;" width="1266" x="94" y="702.5664"/><rect fill="#FFFFFF" filter="url(#fodmp8fzkq3b1)" height="325.7266" style="stroke: #000000; stroke-width: 4.0;" width="1790" x="26" y="1170.7773"/><line style="stroke: #A80036; stroke-width: 2.0; stroke-dasharray: 5.0,5.0;" x1="112" x2="112" y1="172.9766" y2="1530.5039"/><line style="stroke: #A80036; stroke-width: 2.0; stroke-dasharray: 5.0,5.0;" x1="405" x2="405" y1="172.9766" y2="1530.5039"/><line style="stroke: #A80036; stroke-width: 2.0; stroke-dasharray: 5.0,5.0;" x1="682" x2="682" y1="172.9766" y2="1530.5039"/><line style="stroke: #A80036; stroke-width: 2.0; stroke-dasharray: 5.0,5.0;" x1="1040" x2="1040" y1="172.9766" y2="1530.5039"/><line style="stroke: #A80036; stroke-width: 2.0; stroke-dasharray: 5.0,5.0;" x1="1349" x2="1349" y1="172.9766" y2="1530.5039"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="120" x="46" y="167.0703">End user</text><ellipse cx="112" cy="26" fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" rx="16" ry="16" style="stroke: #A80036; stroke-width: 4.0;"/><path d="M112,42 L112,96 M86,58 L138,58 M112,96 L86,126 M112,96 L138,126 " fill="none" filter="url(#fodmp8fzkq3b1)" style="stroke: #A80036; stroke-width: 4.0;"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="120" x="46" y="1555.5742">End user</text><ellipse cx="112" cy="1581.4805" fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" rx="16" ry="16" style="stroke: #A80036; stroke-width: 4.0;"/><path d="M112,1597.4805 L112,1651.4805 M86,1613.4805 L138,1613.4805 M112,1651.4805 L86,1681.4805 M112,1651.4805 L138,1681.4805 " fill="none" filter="url(#fodmp8fzkq3b1)" style="stroke: #A80036; stroke-width: 4.0;"/><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="60.9766" style="stroke: #A80036; stroke-width: 3.0;" width="90" x="357" y="102"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="62" x="371" y="143.0703">API1</text><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="60.9766" style="stroke: #A80036; stroke-width: 3.0;" width="90" x="357" y="1528.5039"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="62" x="371" y="1569.5742">API1</text><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="93.9531" style="stroke: #A80036; stroke-width: 3.0;" width="188" x="584" y="69.0234"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="160" x="598" y="110.0938">ID-provider</text><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="0" x="682" y="143.0703"/><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="93.9531" style="stroke: #A80036; stroke-width: 3.0;" width="188" x="584" y="1528.5039"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="160" x="598" y="1569.5742">ID-provider</text><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="0" x="682" y="1602.5508"/><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="93.9531" style="stroke: #A80036; stroke-width: 3.0;" width="192" x="940" y="69.0234"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="164" x="954" y="110.0938">TokenDings</text><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="0" x="1040" y="143.0703"/><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="93.9531" style="stroke: #A80036; stroke-width: 3.0;" width="192" x="940" y="1528.5039"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="164" x="954" y="1569.5742">TokenDings</text><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="0" x="1040" y="1602.5508"/><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="60.9766" style="stroke: #A80036; stroke-width: 3.0;" width="90" x="1301" y="102"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="62" x="1315" y="143.0703">API2</text><rect fill="#FEFECE" filter="url(#fodmp8fzkq3b1)" height="60.9766" style="stroke: #A80036; stroke-width: 3.0;" width="90" x="1301" y="1528.5039"/><text fill="#000000" font-family="sans-serif" font-size="28" lengthAdjust="spacingAndGlyphs" textLength="62" x="1315" y="1569.5742">API2</text><rect fill="#EEEEEE" filter="url(#fodmp8fzkq3b1)" height="6" style="stroke: #EEEEEE; stroke-width: 2.0;" width="1830" x="6" y="234.2871"/><line style="stroke: #000000; stroke-width: 2.0;" x1="6" x2="1836" y1="234.2871" y2="234.2871"/><line style="stroke: #000000; stroke-width: 2.0;" x1="6" x2="1836" y1="240.2871" y2="240.2871"/><rect fill="#EEEEEE" filter="url(#fodmp8fzkq3b1)" height="46.6211" style="stroke: #000000; stroke-width: 4.0;" width="232" x="805" y="212.9766"/><text fill="#000000" font-family="sans-serif" font-size="26" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="196" x="817" y="246.1133">Login enduser</text><path d="M26,293.5977 L652,293.5977 L652,307.5977 L632,327.5977 L26,327.5977 L26,293.5977 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 2.0;"/><rect fill="none" height="294.3477" style="stroke: #000000; stroke-width: 4.0;" width="774" x="26" y="293.5977"/><text fill="#000000" font-family="sans-serif" font-size="26" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="536" x="56" y="320.7344">OpenID Connect Login (simplified view)</text><polygon fill="#A80036" points="658,362.8398,678,370.8398,658,378.8398,666,370.8398" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="112" x2="670" y1="370.8398" y2="370.8398"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="214" x="126" y="361.3555">Login as enduser</text><polygon fill="#A80036" points="428,492.7031,408,500.7031,428,508.7031,420,500.7031" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="416" x2="680" y1="500.7031" y2="500.7031"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="228" x="440" y="491.2188">get token for API1</text><path d="M118,396.8398 L118,568.8398 L388,568.8398 L388,416.8398 L368,396.8398 L118,396.8398 " fill="#FBFB77" filter="url(#fodmp8fzkq3b1)" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M368,396.8398 L368,416.8398 L388,416.8398 L368,396.8398 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="8" x="130" y="431.9766">{</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="182" x="138" y="462.5977">sub: "enduser"</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="138" x="138" y="493.2188">aud: "API1"</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="220" x="138" y="523.8398">iss: "ID-provider"</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="8" x="130" y="554.4609">}</text><rect fill="#EEEEEE" filter="url(#fodmp8fzkq3b1)" height="6" style="stroke: #EEEEEE; stroke-width: 2.0;" width="1830" x="6" y="643.2559"/><line style="stroke: #000000; stroke-width: 2.0;" x1="6" x2="1836" y1="643.2559" y2="643.2559"/><line style="stroke: #000000; stroke-width: 2.0;" x1="6" x2="1836" y1="649.2559" y2="649.2559"/><rect fill="#EEEEEE" filter="url(#fodmp8fzkq3b1)" height="46.6211" style="stroke: #000000; stroke-width: 4.0;" width="202" x="820" y="621.9453"/><text fill="#000000" font-family="sans-serif" font-size="26" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="166" x="832" y="655.082">API1 to API2</text><path d="M94,702.5664 L828,702.5664 L828,716.5664 L808,736.5664 L94,736.5664 L94,702.5664 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 2.0;"/><rect fill="none" height="440.2109" style="stroke: #000000; stroke-width: 4.0;" width="1266" x="94" y="702.5664"/><text fill="#000000" font-family="sans-serif" font-size="26" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="644" x="124" y="729.7031">Get token for API2 (OAuth 2.0 Token Exchange)</text><polygon fill="#A80036" points="1016,771.8086,1036,779.8086,1016,787.8086,1024,779.8086" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="406" x2="1028" y1="779.8086" y2="779.8086"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="586" x="420" y="770.3242">get token for API2 based on ID-provider token</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="1040" x2="1124" y1="899.6719" y2="899.6719"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1124" x2="1124" y1="899.6719" y2="925.6719"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1042" x2="1124" y1="925.6719" y2="925.6719"/><polygon fill="#A80036" points="1062,917.6719,1042,925.6719,1062,933.6719,1054,925.6719" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="150" x="1054" y="828.9453">verify token</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="258" x="1054" y="859.5664">check access policy:</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="274" x="1062" y="890.1875">can API1 invoke API2?</text><polygon fill="#A80036" points="428,1047.5352,408,1055.5352,428,1063.5352,420,1055.5352" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="416" x2="1038" y1="1055.5352" y2="1055.5352"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="312" x="440" y="1046.0508">issue new token for API2</text><path d="M114,951.6719 L114,1123.6719 L388,1123.6719 L388,971.6719 L368,951.6719 L114,951.6719 " fill="#FBFB77" filter="url(#fodmp8fzkq3b1)" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M368,951.6719 L368,971.6719 L388,971.6719 L368,951.6719 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="8" x="126" y="986.8086">{</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="182" x="134" y="1017.4297">sub: "enduser"</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="138" x="134" y="1048.0508">aud: "API2"</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="224" x="134" y="1078.6719">iss: "TokenDings"</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="8" x="126" y="1109.293">}</text><path d="M26,1170.7773 L542,1170.7773 L542,1184.7773 L522,1204.7773 L26,1204.7773 L26,1170.7773 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 2.0;"/><rect fill="none" height="325.7266" style="stroke: #000000; stroke-width: 4.0;" width="1790" x="26" y="1170.7773"/><text fill="#000000" font-family="sans-serif" font-size="26" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="426" x="56" y="1197.9141">Call API2 with JWT Bearer token</text><polygon fill="#A80036" points="1326,1240.0195,1346,1248.0195,1326,1256.0195,1334,1248.0195" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="406" x2="1338" y1="1248.0195" y2="1248.0195"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="478" x="420" y="1238.5352">call API2 with token from TokenDings</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="1350" x2="1434" y1="1337.2617" y2="1337.2617"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1434" x2="1434" y1="1337.2617" y2="1363.2617"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1352" x2="1434" y1="1363.2617" y2="1363.2617"/><polygon fill="#A80036" points="1372,1355.2617,1352,1363.2617,1372,1371.2617,1364,1363.2617" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="150" x="1364" y="1297.1563">verify token</text><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="428" x="1364" y="1327.7773">access control (based on enduser)</text><polygon fill="#A80036" points="428,1413.8828,408,1421.8828,428,1429.8828,420,1421.8828" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="416" x2="1348" y1="1421.8828" y2="1421.8828"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="232" x="440" y="1412.3984">return information</text><polygon fill="#A80036" points="134,1472.5039,114,1480.5039,134,1488.5039,126,1480.5039" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="122" x2="404" y1="1480.5039" y2="1480.5039"/><text fill="#000000" font-family="sans-serif" font-size="26" lengthAdjust="spacingAndGlyphs" textLength="246" x="146" y="1471.0195">display information</text><!--MD5=[b09c6f7333f47c8731325b6103aeea1b]
@startuml component
actor enduser as "End user"
participant API1
participant idprovider as "ID-provider\n"
participant tokendings as "TokenDings\n"
participant API2


== Login enduser ==
group OpenID Connect Login (simplified view)
enduser -> idprovider: Login as enduser
idprovider -> API1: get token for API1
note left: {\n sub: "enduser"\n aud: "API1"\n iss: "ID-provider"\n}
end
== API1 to API2 ==
group Get token for API2 (OAuth 2.0 Token Exchange)
API1 -> tokendings: get token for API2 based on ID-provider token
tokendings -> tokendings: verify token\ncheck access policy:\n can API1 invoke API2?
tokendings -> API1: issue new token for API2
note left: {\n sub: "enduser"\n aud: "API2"\n iss: "TokenDings"\n}
end
group Call API2 with JWT Bearer token
API1 -> API2: call API2 with token from TokenDings
API2 -> API2: verify token\naccess control (based on enduser)
API2 -> API1: return information
API1 -> enduser: display information
end
@enduml

PlantUML version 1.2020.03beta6(Unknown compile time)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.6+8-b765.25
Operating System: Mac OS X
Default Encoding: UTF-8
Language: nb
Country: NO
--></g></svg>